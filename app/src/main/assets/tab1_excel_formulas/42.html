<html><head><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /></head><style>#t{text-align:justify;line-height:1.5;border-style:solid;border-width:0px;border-color:#000 #000;font-size:16px;background-color:#ffffff;border-radius:0px;	font-size:16px;padding:8px 12px 8px 12px;background-image:"gambar/paper.png"	font-family:"Trebuchet MS, Helvetica, sans-serif"}#t h1{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h3{padding-bottom:5px;padding-top:5px;font-size:20px;	color:white;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:0px;border-top:0px;border-left:0px;border-right:0px;background-color:#E76E66;border-radius:0px;line-height:1;font-family:"arial"	}#t h2{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h4{padding-bottom:5px;padding-top:5px;font-size:14px;margin-bottom:10px;text-align:left;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;}.arab{font-size:25px!important;line-height:46px!important;font-family:"Times New Roman",Tahoma,sans-serif;font-weight:normal;text-align:right;direction:rtl;}.my-wrapper{padding-top:30px;}.my-wrapper form{position:fixed;top:0px;left:15px;min-width:95%;	padding-right:25px;z-index:2;}.wrap{white-space:normal!important;}p{text-indent:0%;}.c{text-align:center;}.effect8{position:relative;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;-moz-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;}.effect8:before,.effect8:after{content:"";position:absolute;z-index:-1;-webkit-box-shadow:0 0 20px rgba(0,0,0,0.8);-moz-box-shadow:0 0 20px rgba(0,0,0,0.8);box-shadow:0 0 20px rgba(0,0,0,0.8);top:10px;bottom:10px;left:0;right:0;-moz-border-radius:100px/10px;border-radius:100px/10px;}.effect8:after{right:10px;left:auto;-webkit-transform:skew(8deg)rotate(3deg);-moz-transform:skew(8deg)rotate(3deg);-ms-transform:skew(8deg)rotate(3deg);-o-transform:skew(8deg)rotate(3deg);transform:skew(8deg)rotate(3deg);}img{display:block;margin:0 auto;	max-width:100%;	vertical-align:middle;	horizontal-align:left;	height:auto;	}.image{-webkit-border-radius:0px;-moz-border-radius:0px;border-radius:0px;border-top-left-radius:0px!important;border-bottom-left-radius:0px!important;	position:absolute;top:0;bottom:0;	left:5px;margin:auto;}@media screen and(max-width:640px){table{overflow-x:auto;display:block;	}			td,th{border:1px solid #999;padding:0.3rem;}}ol{	counter-reset:li;	margin-left:0;	padding-left:0;}ol>li{	position:relative;	margin:0 0 6px 2em;	padding:4px 8px;	list-style:none;	border-top:2px solid #666;	background:#f6f6f6;}ol>li:before{	content:counter(li);	counter-increment:li;		position:absolute;	top:-2px;	left:-2em;	-moz-box-sizing:border-box;	-webkit-box-sizing:border-box;	box-sizing:border-box;	width:2em;		margin-right:8px;	padding:4px;	border-top:2px solid #666;	color:#fff;	background:#666;	font-weight:bold;	font-family:"Helvetica Neue",Arial,sans-serif;	text-align:center;}li ol,li ul{margin-top:6px;}ol ol li:last-child{margin-bottom:0;}.wrap2{white-space:normal!important;	text-align:right;}pre{font-family:"Courier 10 Pitch",Courier,monospace;font-size:95%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;		background:#f6f6f6;		word-wrap:break-word;}code{font-family:Monaco,Consolas,"Andale Mono","DejaVu Sans Mono",monospace;font-size:85%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;background:#faf8f0;}#content code{display:block;padding:0.5em 1em;border:1px solid #bebab0;}</style><body><div data-role=page id=eps160 data-theme=d><div></div><div data-role=content><div id=t><div><div><div><div><h1>Count unique text values with criteria</h1><div><div><div><div><div><div><div><img src=gambar/114.png alt="" data-elem=pinchzoomer /></div></div></div><div><h3>Generic formula&nbsp;</h3><div><div><div><pre>{=SUM(--(FREQUENCY(IF(criteria,MATCH(values,values,0)),ROW(values)-ROW(values.firstcell)+1)&gt;0))}</pre></div></div></div></div><div><div>Related formulas&nbsp;</div><div><div>Count unique numeric values with criteria</div><div>Count unique numeric values in a range</div><div>Count unique values in a range with COUNTIF</div><div>Count unique text values in a range</div></div></div><div><h3>Explanation&nbsp;</h3><div><div><p>To unique values in a range with a criteria, you can use an array formula based on the FREQUENCY function.</p><p>Assume you have a list of employee names together with hours worked on "Project X", and you want know how many employees worked on that project. Looking at the data, you can see that the same employee names appear more than once, so what you want is a count of the unique names.</p><p>In the example shown, the formula in G6 is:</p><div><pre>=SUM(--(FREQUENCY(IF(C5:C11=G5,MATCH(B5:B11,B5:B11,0)),ROW(B5:B11)-ROW(B5)+1)&gt;0))</pre></div><h3>How this formula works</h3><p>This formula uses FREQUENCY to count unique numeric values that are derived with the MATCH function, which matches all values against themselves to determine a position.</p><p>Working from the inside, the MATCH function is used to get the position of each item that appears in the data. Because MATCH only returns the position of the "first match" values that appear more than once in the data return the same number.</p><p>Just outside of MATCH, the IF + criteria "filter" the values that MATCH works with so that it only returns MATCHES for rows that match criteria.</p><p>In the end, the&nbsp;array of positions generated by MATCH are fed to FREQUENCY in the data array argument.</p><p>The bins array argument is constructed from this part of the formula:</p><div><pre>ROW(B3:B12)-ROW(B3)+1</pre></div><p>which uses the row number of each item in the data and the row number of the first item in the data to build a straight, sequential array like this:</p><p>{1;2;3;4;5;6;7;8;9;10}</p><p>The FREQUENCY function returns an array of values that correspond to "bins". In this case, we are supplying the same set of numbers for both the data array and bins array.</p><p>The result is that FREQUENCY returns an array of values that indicate the count that each value in the data array appears. This works because FREQUENCY is programmed to return zero for any numbers that appear more than once in the data array.</p><p>Next, each of these values is converted to TRUE or FALSE by the &gt;0 construction, and then to 1 or zero with the double-unary (double-hyphen). This is done to force all non-zero values to 1.</p><p>Finally, SUMPRODUCT simply adds these values up and returns the total</p><p><I>Note: this is an array formula and must be entered using Control + Shift + Enter.</I></p><h3>Handling empty cells in the range</h3><p>If any of the cells in the range are empty, you'll need to adjust the formula by adding an extra IF to prevent empty cells from being passed into the MATCH function, which will throw an error. The formula in G7 is:</p><div><pre>{=SUM(--(FREQUENCY(IF(B5:B11&lt;&gt;"",IF(C5:C11=G5,MATCH(B5:B11,B5:B11,0))),ROW(B5:B11)-ROW(B5)+1)&gt;0))}</pre></div><h3>With two criteria</h3><p>If you have two criteria, you can extend the logic of the formula by adding another nested IF:</p><div><pre>=SUM(--(FREQUENCY(IF(c1,IF(c2,MATCH(vals,vals,0))),ROW(vals)-ROW(vals.1st)+1)&gt;0))</pre></div><p>Where <B>c1</B> = criteria1, <B>c2</B> = criteria2 and <B>vals</B> = the values range.</p><div>Adapted from&nbsp;Mike Givin's excellent book on array formulas, <I>Control-Shift-Enter.</I></div></div></div></div><div><div></div></div><div data-role=footer data-position=fixed data-tap-toggle=false data-theme=c><a href=#pageone data-rel=back data-icon=home data-iconpos="" data-shadow=true data-iconshadow=true>Back</a></div></div><meta charset=utf-8 /><link rel=stylesheet type=text/css href=css/jquery.mobile.squareui.css /><script src="js/jquery.js"></script> <script src="js/jquery.mobile-1.4.0.min.js"></script><link href=css/pinchzoomer.min.css rel=stylesheet><link href=css/fullscreen.min.css rel=stylesheet><script src="js/jquery-1.10.0.min.js" type="text/javascript"></script> <script src="js/bootstrap.min.js" type="text/javascript"></script> <script src="js/modernizr.min.js" type="text/javascript"></script> <script src="js/jquery.mousewheel.min.js"></script> <script src="js/jquery.hammer.min.js" type="text/javascript"></script> <script src="js/TweenMax.min.js" type="text/javascript"></script> <script src="js/fullscreen.min.js" type="text/javascript"></script><meta name=format-detection content=telephone=no /></body></html>