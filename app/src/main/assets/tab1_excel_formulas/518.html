<html><head><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /></head><style>#t{text-align:justify;line-height:1.5;border-style:solid;border-width:0px;border-color:#000 #000;font-size:16px;background-color:#ffffff;border-radius:0px;	font-size:16px;padding:8px 12px 8px 12px;background-image:"gambar/paper.png"	font-family:"Trebuchet MS, Helvetica, sans-serif"}#t h1{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h3{padding-bottom:5px;padding-top:5px;font-size:20px;	color:white;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:0px;border-top:0px;border-left:0px;border-right:0px;background-color:#E76E66;border-radius:0px;line-height:1;font-family:"arial"	}#t h2{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h4{padding-bottom:5px;padding-top:5px;font-size:14px;margin-bottom:10px;text-align:left;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;}.arab{font-size:25px!important;line-height:46px!important;font-family:"Times New Roman",Tahoma,sans-serif;font-weight:normal;text-align:right;direction:rtl;}.my-wrapper{padding-top:30px;}.my-wrapper form{position:fixed;top:0px;left:15px;min-width:95%;	padding-right:25px;z-index:2;}.wrap{white-space:normal!important;}p{text-indent:0%;}.c{text-align:center;}.effect8{position:relative;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;-moz-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;}.effect8:before,.effect8:after{content:"";position:absolute;z-index:-1;-webkit-box-shadow:0 0 20px rgba(0,0,0,0.8);-moz-box-shadow:0 0 20px rgba(0,0,0,0.8);box-shadow:0 0 20px rgba(0,0,0,0.8);top:10px;bottom:10px;left:0;right:0;-moz-border-radius:100px/10px;border-radius:100px/10px;}.effect8:after{right:10px;left:auto;-webkit-transform:skew(8deg)rotate(3deg);-moz-transform:skew(8deg)rotate(3deg);-ms-transform:skew(8deg)rotate(3deg);-o-transform:skew(8deg)rotate(3deg);transform:skew(8deg)rotate(3deg);}img{display:block;margin:0 auto;	max-width:100%;	vertical-align:middle;	horizontal-align:left;	height:auto;	}.image{-webkit-border-radius:0px;-moz-border-radius:0px;border-radius:0px;border-top-left-radius:0px!important;border-bottom-left-radius:0px!important;	position:absolute;top:0;bottom:0;	left:5px;margin:auto;}@media screen and(max-width:640px){table{overflow-x:auto;display:block;	}			td,th{border:1px solid #999;padding:0.3rem;}}ol{	counter-reset:li;	margin-left:0;	padding-left:0;}ol>li{	position:relative;	margin:0 0 6px 2em;	padding:4px 8px;	list-style:none;	border-top:2px solid #666;	background:#f6f6f6;}ol>li:before{	content:counter(li);	counter-increment:li;		position:absolute;	top:-2px;	left:-2em;	-moz-box-sizing:border-box;	-webkit-box-sizing:border-box;	box-sizing:border-box;	width:2em;		margin-right:8px;	padding:4px;	border-top:2px solid #666;	color:#fff;	background:#666;	font-weight:bold;	font-family:"Helvetica Neue",Arial,sans-serif;	text-align:center;}li ol,li ul{margin-top:6px;}ol ol li:last-child{margin-bottom:0;}.wrap2{white-space:normal!important;	text-align:right;}pre{font-family:"Courier 10 Pitch",Courier,monospace;font-size:95%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;		background:#f6f6f6;		word-wrap:break-word;}code{font-family:Monaco,Consolas,"Andale Mono","DejaVu Sans Mono",monospace;font-size:85%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;background:#faf8f0;}#content code{display:block;padding:0.5em 1em;border:1px solid #bebab0;}</style><body><div data-role=page id=eps160 data-theme=d><div></div><div data-role=content><div id=t><div><div><div><div><h1>Lookup last file revision</h1><div><div><div><div><div><div><div><img src=gambar/356.png alt="" data-elem=pinchzoomer /></div></div></div><div><h3>Generic formula&nbsp;</h3><div><div><div><pre>{=MAX(IF(ISERROR(SEARCH(H5&amp;"*",files)),0,ROW(files)-ROW(INDEX(files,1,1))+1))}</pre></div></div></div></div><div><div>Related formulas&nbsp;</div><div><div>Get nth match with INDEX / MATCH</div><div>Get relative row numbers in range</div><div>Get last match</div></div></div><div><h3>Explanation&nbsp;</h3><div><div><p>To find the position (row)&nbsp;of the last file revision in a table, you can use a formula based on several Excel functions: MAX, IF, ISERROR, ROW, and INDEX.</p><p>In the example shown, the formula in cell H6 is:</p><p>{=MAX(IF(ISERROR(SEARCH(H5&amp;"*",files)),0,ROW(files)-ROW(INDEX(files,1,1))+1))}</p><p>where "files" is the named range C4:C11.</p><p><I>Note: this is an array formula and must be entered with control + shift + enter.</I></p><h3>Context</h3><p>In this example, we have a number of file versions listed in a table with a date and user name. Note that file names are repeated, except for the code appended at the end to represent version ("CA", "CB", "CC", "CD", etc.).</p><p>For a given file, we want to locate the position (row number) for the last revision. This is a tricky problem, because the version codes at the end of the file names make it harder to match on the file name. Also, by default, Excel match formulas will return the first match, not the last match, so we need to work around that challenge with some tricky techniques.&nbsp;</p><h3>How this formula works</h3><p>At the core of this formula, we build a list of row numbers for a given file. Then we use the MAX function to get the largest row number, which corresponds to the last revision (last occurrence) of that file.</p><p>To find all occurrences of a given file, we use the SEARCH function, configured with the asterisk (*) wildcard to match the file name, ignoring the version codes. SEARCH will throw a VALUE error when text isn't found, so we wrap search in ISERROR:</p><div><pre>ISERROR(SEARCH(H5&amp;"*",files))</pre></div><p>This results in an array of TRUE and FALSE values like this:</p><p>{FALSE;TRUE;FALSE;FALSE;TRUE;TRUE;FALSE;TRUE}</p><p>It's confusing, but TRUE represents an error (text not found), and FALSE represents a match. This array result is fed into the IF function as the logical test. For value if TRUE, we use zero, and for value if true, we supply this code, which generates relative row numbers for the range we are working with:</p><div><pre>ROW(files)-ROW(INDEX(files,1,1))+1)</pre></div><p>The IF function then returns an array of values like this:</p><p>{1;0;3;4;0;0;7;0}</p><p>All numbers except zero&nbsp;represent matches for "filename1" &ndash;&nbsp;i.e. the&nbsp;row number inside the named range "files" where "filename1" appears.</p><p>Finally, we use the MAX function to get the maximum value in this array, which is 7 in this example.</p><p>Use INDEX with this row number to retrieve information related to the last revision (i.e. full file name, date, user, etc).</p><h3>Without named range</h3><p>Named ranges make it fast and easy to set up a more complex formula, since you don't have to enter cell addresses by hand. However, in this case, we are using an extra function (INDEX) to get the first cell of the named range "files", which complicates things a bit. Without the named range, the formula looks like this:</p><div><pre>{=MAX(IF(ISERROR(SEARCH(H5&amp;"*",C4:C11)),0,ROW(C4:C11)-ROW(C4)+1))}</pre></div></div></div></div><div><div></div></div><div data-role=footer data-position=fixed data-tap-toggle=false data-theme=c><a href=#pageone data-rel=back data-icon=home data-iconpos="" data-shadow=true data-iconshadow=true>Back</a></div></div><meta charset=utf-8 /><link rel=stylesheet type=text/css href=css/jquery.mobile.squareui.css /><script src="js/jquery.js"></script> <script src="js/jquery.mobile-1.4.0.min.js"></script><link href=css/pinchzoomer.min.css rel=stylesheet><link href=css/fullscreen.min.css rel=stylesheet><script src="js/jquery-1.10.0.min.js" type="text/javascript"></script> <script src="js/bootstrap.min.js" type="text/javascript"></script> <script src="js/modernizr.min.js" type="text/javascript"></script> <script src="js/jquery.mousewheel.min.js"></script> <script src="js/jquery.hammer.min.js" type="text/javascript"></script> <script src="js/TweenMax.min.js" type="text/javascript"></script> <script src="js/fullscreen.min.js" type="text/javascript"></script><meta name=format-detection content=telephone=no /></body></html>