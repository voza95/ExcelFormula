<html><head><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /></head><style>#t{text-align:justify;line-height:1.5;border-style:solid;border-width:0px;border-color:#000 #000;font-size:16px;background-color:#ffffff;border-radius:0px;	font-size:16px;padding:8px 12px 8px 12px;background-image:"gambar/paper.png"	font-family:"Trebuchet MS, Helvetica, sans-serif"}#t h1{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h3{padding-bottom:5px;padding-top:5px;font-size:20px;	color:white;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:0px;border-top:0px;border-left:0px;border-right:0px;background-color:#E76E66;border-radius:0px;line-height:1;font-family:"arial"	}#t h2{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h4{padding-bottom:5px;padding-top:5px;font-size:14px;margin-bottom:10px;text-align:left;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;}.arab{font-size:25px!important;line-height:46px!important;font-family:"Times New Roman",Tahoma,sans-serif;font-weight:normal;text-align:right;direction:rtl;}.my-wrapper{padding-top:30px;}.my-wrapper form{position:fixed;top:0px;left:15px;min-width:95%;	padding-right:25px;z-index:2;}.wrap{white-space:normal!important;}p{text-indent:0%;}.c{text-align:center;}.effect8{position:relative;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;-moz-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;}.effect8:before,.effect8:after{content:"";position:absolute;z-index:-1;-webkit-box-shadow:0 0 20px rgba(0,0,0,0.8);-moz-box-shadow:0 0 20px rgba(0,0,0,0.8);box-shadow:0 0 20px rgba(0,0,0,0.8);top:10px;bottom:10px;left:0;right:0;-moz-border-radius:100px/10px;border-radius:100px/10px;}.effect8:after{right:10px;left:auto;-webkit-transform:skew(8deg)rotate(3deg);-moz-transform:skew(8deg)rotate(3deg);-ms-transform:skew(8deg)rotate(3deg);-o-transform:skew(8deg)rotate(3deg);transform:skew(8deg)rotate(3deg);}img{display:block;margin:0 auto;	max-width:100%;	vertical-align:middle;	horizontal-align:left;	height:auto;	}.image{-webkit-border-radius:0px;-moz-border-radius:0px;border-radius:0px;border-top-left-radius:0px!important;border-bottom-left-radius:0px!important;	position:absolute;top:0;bottom:0;	left:5px;margin:auto;}@media screen and(max-width:640px){table{overflow-x:auto;display:block;	}			td,th{border:1px solid #999;padding:0.3rem;}}ol{	counter-reset:li;	margin-left:0;	padding-left:0;}ol>li{	position:relative;	margin:0 0 6px 2em;	padding:4px 8px;	list-style:none;	border-top:2px solid #666;	background:#f6f6f6;}ol>li:before{	content:counter(li);	counter-increment:li;		position:absolute;	top:-2px;	left:-2em;	-moz-box-sizing:border-box;	-webkit-box-sizing:border-box;	box-sizing:border-box;	width:2em;		margin-right:8px;	padding:4px;	border-top:2px solid #666;	color:#fff;	background:#666;	font-weight:bold;	font-family:"Helvetica Neue",Arial,sans-serif;	text-align:center;}li ol,li ul{margin-top:6px;}ol ol li:last-child{margin-bottom:0;}.wrap2{white-space:normal!important;	text-align:right;}pre{font-family:"Courier 10 Pitch",Courier,monospace;font-size:95%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;		background:#f6f6f6;		word-wrap:break-word;}code{font-family:Monaco,Consolas,"Andale Mono","DejaVu Sans Mono",monospace;font-size:85%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;background:#faf8f0;}#content code{display:block;padding:0.5em 1em;border:1px solid #bebab0;}</style><body><div data-role=page id=eps160 data-theme=d><div></div><div data-role=content><div id=t><div><div><div><div><h1>Dynamic named range with OFFSET</h1><div><div><div><div><div><div><div><img src=gambar/153.png alt="" data-elem=pinchzoomer /></div></div></div><div><h3>Generic formula&nbsp;</h3><div><div><div><pre>=OFFSET(origin,0,0,COUNTA(range),COUNTA(range))</pre></div></div></div></div><div><div>Related formulas&nbsp;</div><div><div>Dynamic named range with INDEX</div></div></div><div><h3>Explanation&nbsp;</h3><div><div><p>One way to create a dynamic named range with a formula is to use the OFFSET function together with the COUNTA function. Dynamic ranges are also known as expanding ranges - they automatically expand and contract to accommodate new or deleted data.</p><p><I>Note: OFFSET is a volatile function, which means it recalculates with every change to a worksheet. With a modern machine and smaller data set, this should't cause a problem but you may see slower performance on large data sets. In that case, consider building a dynamic named range with the INDEX function instead.</I></p><p>In the example shown, the formula used for the dynamic range is:</p><div><pre>=OFFSET(B5,0,0,COUNTA($B$5:$B$100),COUNTA($B$4:$Z$4))</pre></div><div><I>Note: this formula is meant to define a named range&nbsp;that can be used in other formulas.</I></div><h3>How this formula works</h3><p>This formula uses the OFFSET function to generate a range that expands and contracts by adjusting height and width based on a count of non-empty cells.</p><p>The first argument in OFFSET represents the first cell in the data (the origin), which in this case is cell B5. The next two arguments are offsets for rows and columns, and are supplied as zero.</p><p>The last two arguments represent height and width. Height and width are generated on the fly by using COUNTA, which makes the the resulting reference dynamic.</p><p>For height, we use the COUNTA function to count non-empty values in the range B5:B100. This assumes no blank values in the data, and no values beyond B100. COUNTA returns 6.</p><p>For width, we use the COUNTA function to count non-empty values in the range B5:Z5. This assumes no header cells, and no headers beyond Z5. COUNTA returns 6.</p><p>At this point, the formula looks like this:</p><div><pre>=OFFSET(B5,0,0,6,6)</pre></div><p>With this information, OFFSET returns a reference to B6:I15, which corresponds to a range 6 rows height by 6 columns across.&nbsp;</p><p>Note: The ranges used for height and width should be adjusted to match the worksheet layout.</p><h3>Variation with full column/row references</h3><p>You can also use full column and row references for height and width like so:</p><div><pre>=OFFSET($B$5,0,0,COUNTA($B:$B)-2,COUNTA($4:$4))</pre></div><p>Note that height is being adjusted with -2 to take into account header and title values in cells B4 and B2. The advantage to this approach is the simplicity of the ranges inside COUNTA. The disadvantage comes from the huge size full columns and rows &mdash; care must be taken to prevent errant values out side the range, as they can easily throw off the count.</p><h3>Determining the last row</h3><p>There are several ways to determine the last row (last relative position) in a set of data, depending on the structure and content of the data in the worksheet:</p><ul><li>Last row in mixed data with blanks</li><li>Last row in mixed data with no blanks</li><li>Last row in text data</li><li>Last row in numeric data</li></ul></div></div></div><div><div></div></div><div data-role=footer data-position=fixed data-tap-toggle=false data-theme=c><a href=#pageone data-rel=back data-icon=home data-iconpos="" data-shadow=true data-iconshadow=true>Back</a></div></div><meta charset=utf-8 /><link rel=stylesheet type=text/css href=css/jquery.mobile.squareui.css /><script src="js/jquery.js"></script> <script src="js/jquery.mobile-1.4.0.min.js"></script><link href=css/pinchzoomer.min.css rel=stylesheet><link href=css/fullscreen.min.css rel=stylesheet><script src="js/jquery-1.10.0.min.js" type="text/javascript"></script> <script src="js/bootstrap.min.js" type="text/javascript"></script> <script src="js/modernizr.min.js" type="text/javascript"></script> <script src="js/jquery.mousewheel.min.js"></script> <script src="js/jquery.hammer.min.js" type="text/javascript"></script> <script src="js/TweenMax.min.js" type="text/javascript"></script> <script src="js/fullscreen.min.js" type="text/javascript"></script><meta name=format-detection content=telephone=no /></body></html>