<html><head><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /></head><style>#t{text-align:justify;line-height:1.5;border-style:solid;border-width:0px;border-color:#000 #000;font-size:16px;background-color:#ffffff;border-radius:0px;	font-size:16px;padding:8px 12px 8px 12px;background-image:"gambar/paper.png"	font-family:"Trebuchet MS, Helvetica, sans-serif"}#t h1{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h3{padding-bottom:5px;padding-top:5px;font-size:20px;	color:white;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:0px;border-top:0px;border-left:0px;border-right:0px;background-color:#E76E66;border-radius:0px;line-height:1;font-family:"arial"	}#t h2{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h4{padding-bottom:5px;padding-top:5px;font-size:14px;margin-bottom:10px;text-align:left;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;}.arab{font-size:25px!important;line-height:46px!important;font-family:"Times New Roman",Tahoma,sans-serif;font-weight:normal;text-align:right;direction:rtl;}.my-wrapper{padding-top:30px;}.my-wrapper form{position:fixed;top:0px;left:15px;min-width:95%;	padding-right:25px;z-index:2;}.wrap{white-space:normal!important;}p{text-indent:0%;}.c{text-align:center;}.effect8{position:relative;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;-moz-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;}.effect8:before,.effect8:after{content:"";position:absolute;z-index:-1;-webkit-box-shadow:0 0 20px rgba(0,0,0,0.8);-moz-box-shadow:0 0 20px rgba(0,0,0,0.8);box-shadow:0 0 20px rgba(0,0,0,0.8);top:10px;bottom:10px;left:0;right:0;-moz-border-radius:100px/10px;border-radius:100px/10px;}.effect8:after{right:10px;left:auto;-webkit-transform:skew(8deg)rotate(3deg);-moz-transform:skew(8deg)rotate(3deg);-ms-transform:skew(8deg)rotate(3deg);-o-transform:skew(8deg)rotate(3deg);transform:skew(8deg)rotate(3deg);}img{display:block;margin:0 auto;	max-width:100%;	vertical-align:middle;	horizontal-align:left;	height:auto;	}.image{-webkit-border-radius:0px;-moz-border-radius:0px;border-radius:0px;border-top-left-radius:0px!important;border-bottom-left-radius:0px!important;	position:absolute;top:0;bottom:0;	left:5px;margin:auto;}@media screen and(max-width:640px){table{overflow-x:auto;display:block;	}			td,th{border:1px solid #999;padding:0.3rem;}}ol{	counter-reset:li;	margin-left:0;	padding-left:0;}ol>li{	position:relative;	margin:0 0 6px 2em;	padding:4px 8px;	list-style:none;	border-top:2px solid #666;	background:#f6f6f6;}ol>li:before{	content:counter(li);	counter-increment:li;		position:absolute;	top:-2px;	left:-2em;	-moz-box-sizing:border-box;	-webkit-box-sizing:border-box;	box-sizing:border-box;	width:2em;		margin-right:8px;	padding:4px;	border-top:2px solid #666;	color:#fff;	background:#666;	font-weight:bold;	font-family:"Helvetica Neue",Arial,sans-serif;	text-align:center;}li ol,li ul{margin-top:6px;}ol ol li:last-child{margin-bottom:0;}.wrap2{white-space:normal!important;	text-align:right;}pre{font-family:"Courier 10 Pitch",Courier,monospace;font-size:95%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;		background:#f6f6f6;		word-wrap:break-word;}code{font-family:Monaco,Consolas,"Andale Mono","DejaVu Sans Mono",monospace;font-size:85%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;background:#faf8f0;}#content code{display:block;padding:0.5em 1em;border:1px solid #bebab0;}</style><body><div data-role=page id=eps160 data-theme=d><div></div><div data-role=content><div id=t><div><div><div><div><h1>Extract data with helper column</h1><div><div><div><div><div><div><div><img src=gambar/188.png alt="" data-elem=pinchzoomer /></div></div></div><div><h3>Generic formula&nbsp;</h3><div><div><div><pre>=IF(rowcheck,INDEX(data,MATCH(rownum,helper,0),column),"")</pre></div></div></div></div><div><div>Related formulas&nbsp;</div><div><div>Get nth match with INDEX / MATCH</div><div>Get nth match with VLOOKUP</div></div></div><div><h3>Explanation&nbsp;</h3><div><div><p>One way to extract data in Excel is to use INDEX and MATCH with a helper column that marks matching data. This avoids the complexity of a more advanced array formula.</p><p>In the example shown, the formula in H6 is:</p><div><pre>=IF($G6&lt;=ct,INDEX(data,MATCH($G6,helper,0),1),"")</pre></div><h3>How this formula works</h3><p>The challenge with extraction formulas is managing duplicates (i.e. multiple matches).&nbsp;Lookup formulas like VLOOKUP and INDEX + MATCH can easily find the first match, but it's much harder to lookup "all matches" when criteria select more than one match.</p><p>This formula deals with this challenge by using a helper column that returns a numeric value that can be used to easily extract multiple matches.</p><p>The formula in the helper column looks like this:</p><div><pre>=SUM(E2,AND(C3=$I$3,D3=$J$3))</pre></div><p>The helper column tests each row in the data to see if the Department in column C matches the value in I3 and the Building in column D matches the value in J3. Both logical tests must return TRUE in order for AND to return TRUE.</p><p>For each row, the result of AND is added to the "value above" in the helper column to generate a count. The practical effect of this formula is an incrementing counter that only changes when a (new) match is found. Then the value remains the same until the next match is found. This works because the TRUE/FALSE results return by AND are coerced to 1/0 values as part of the sum operation. FALSE results add nothing, and TRUE results add 1.</p><p>Back in the extraction area, the lookup formula for Name in column H looks like this:</p><div><pre>=IF($G6&lt;=ct,INDEX(data,MATCH($G6,helper,0),1),"")</pre></div><p>Working from the inside out, the INDEX MATCH part of the formula looks up the name for the first match found, using the row number in column G as the match value:</p><div><pre>INDEX(data,MATCH($G6,helper,0),1)</pre></div><p>INDEX receives all 3 columns of data as the array (named range "data"), and MATCH is configured to match the row number inside the helper column (the named range "helper") in exact match mode (3rd argument set to zero).</p><p>This is where the cleverness of the formula becomes apparent. The helper column obviously contains duplicates, but it doesn't matter, because MATCH will match only the first value. By design, each "first value" corresponds to the correct row in the data table.</p><p>The formulas in columns I and J are the same as H, except for the column number, which is increased in each case by one.</p><p>The IF statement that wraps the INDEX/MATCH formula performs a simple function &mdash; it checks each row number in the extraction area to see if the row number is less than or equal to the value in G3 (named range "ct"), which is the total count of all matching records. If so, the INDEX/MATCH logic is run. If not, IF outputs an empty string ("").</p><p>The formula in G3 (named range "ct") is simple:</p><div><pre>=MAX(helper)</pre></div><p>Since the maximum value in the helper column is the same as the total match count, the MAX function is all we need.&nbsp;</p><p><I>Note: the extraction area needs to be manually configured to handle as much data as needed (i.e. 5 rows, 10 rows, 20 rows,&nbsp;etc.). In this example, it is limited to 5 rows only to keep the worksheet compact.</I></p><p><I>I learned this technique in&nbsp;Mike Girvin's&nbsp;book Control + Shift + Enter.</I></p></div></div></div><div><div></div></div><div data-role=footer data-position=fixed data-tap-toggle=false data-theme=c><a href=#pageone data-rel=back data-icon=home data-iconpos="" data-shadow=true data-iconshadow=true>Back</a></div></div><meta charset=utf-8 /><link rel=stylesheet type=text/css href=css/jquery.mobile.squareui.css /><script src="js/jquery.js"></script> <script src="js/jquery.mobile-1.4.0.min.js"></script><link href=css/pinchzoomer.min.css rel=stylesheet><link href=css/fullscreen.min.css rel=stylesheet><script src="js/jquery-1.10.0.min.js" type="text/javascript"></script> <script src="js/bootstrap.min.js" type="text/javascript"></script> <script src="js/modernizr.min.js" type="text/javascript"></script> <script src="js/jquery.mousewheel.min.js"></script> <script src="js/jquery.hammer.min.js" type="text/javascript"></script> <script src="js/TweenMax.min.js" type="text/javascript"></script> <script src="js/fullscreen.min.js" type="text/javascript"></script><meta name=format-detection content=telephone=no /></body></html>