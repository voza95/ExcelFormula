<html><head><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /></head><style>#t{text-align:justify;line-height:1.5;border-style:solid;border-width:0px;border-color:#000 #000;font-size:16px;background-color:#ffffff;border-radius:0px;	font-size:16px;padding:8px 12px 8px 12px;background-image:"gambar/paper.png"	font-family:"Trebuchet MS, Helvetica, sans-serif"}#t h1{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h3{padding-bottom:5px;padding-top:5px;font-size:20px;	color:white;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:0px;border-top:0px;border-left:0px;border-right:0px;background-color:#E76E66;border-radius:0px;line-height:1;font-family:"arial"	}#t h2{padding-bottom:5px;padding-top:5px;font-size:22px;margin-bottom:10px;text-align:center;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;font-family:"georgia"}#t h4{padding-bottom:5px;padding-top:5px;font-size:14px;margin-bottom:10px;text-align:left;border-style:solid;border-bottom:double #666;border-top:double;border-left:0px;border-right:0px;background-color:none;border-radius:0px;line-height:1;}.arab{font-size:25px!important;line-height:46px!important;font-family:"Times New Roman",Tahoma,sans-serif;font-weight:normal;text-align:right;direction:rtl;}.my-wrapper{padding-top:30px;}.my-wrapper form{position:fixed;top:0px;left:15px;min-width:95%;	padding-right:25px;z-index:2;}.wrap{white-space:normal!important;}p{text-indent:0%;}.c{text-align:center;}.effect8{position:relative;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;-moz-box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;box-shadow:0 1px 4px rgba(0,0,0,0.3),0 0 40px rgba(0,0,0,0.1)inset;}.effect8:before,.effect8:after{content:"";position:absolute;z-index:-1;-webkit-box-shadow:0 0 20px rgba(0,0,0,0.8);-moz-box-shadow:0 0 20px rgba(0,0,0,0.8);box-shadow:0 0 20px rgba(0,0,0,0.8);top:10px;bottom:10px;left:0;right:0;-moz-border-radius:100px/10px;border-radius:100px/10px;}.effect8:after{right:10px;left:auto;-webkit-transform:skew(8deg)rotate(3deg);-moz-transform:skew(8deg)rotate(3deg);-ms-transform:skew(8deg)rotate(3deg);-o-transform:skew(8deg)rotate(3deg);transform:skew(8deg)rotate(3deg);}img{display:block;margin:0 auto;	max-width:100%;	vertical-align:middle;	horizontal-align:left;	height:auto;	}.image{-webkit-border-radius:0px;-moz-border-radius:0px;border-radius:0px;border-top-left-radius:0px!important;border-bottom-left-radius:0px!important;	position:absolute;top:0;bottom:0;	left:5px;margin:auto;}@media screen and(max-width:640px){table{overflow-x:auto;display:block;	}			td,th{border:1px solid #999;padding:0.3rem;}}ol{	counter-reset:li;	margin-left:0;	padding-left:0;}ol>li{	position:relative;	margin:0 0 6px 2em;	padding:4px 8px;	list-style:none;	border-top:2px solid #666;	background:#f6f6f6;}ol>li:before{	content:counter(li);	counter-increment:li;		position:absolute;	top:-2px;	left:-2em;	-moz-box-sizing:border-box;	-webkit-box-sizing:border-box;	box-sizing:border-box;	width:2em;		margin-right:8px;	padding:4px;	border-top:2px solid #666;	color:#fff;	background:#666;	font-weight:bold;	font-family:"Helvetica Neue",Arial,sans-serif;	text-align:center;}li ol,li ul{margin-top:6px;}ol ol li:last-child{margin-bottom:0;}.wrap2{white-space:normal!important;	text-align:right;}pre{font-family:"Courier 10 Pitch",Courier,monospace;font-size:95%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;		background:#f6f6f6;		word-wrap:break-word;}code{font-family:Monaco,Consolas,"Andale Mono","DejaVu Sans Mono",monospace;font-size:85%;line-height:140%;white-space:pre;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;background:#faf8f0;}#content code{display:block;padding:0.5em 1em;border:1px solid #bebab0;}</style><body><div data-role=page id=eps160 data-theme=d><div></div><div data-role=content><div id=t><div><div><div><div><h1>Search multiple worksheets for value</h1><div><div><div><div><div><div><div><img src=https://exceljet.net/sites/default/files/styles/function_screen/public/images/formulas/search%20multiple%20worksheets%20for%20value.png?itok=0YSFEu39 alt="" data-elem=pinchzoomer /></div></div></div><div><h3>Generic formula&nbsp;</h3><div><div><div><pre>=COUNTIF(INDIRECT("'"&amp;sheetname&amp;"'!"&amp;"range"),criteria)</pre></div></div></div></div><div><div>Related formulas&nbsp;</div><div><div>Search entire worksheet for value</div><div>Count occurrences in entire workbook</div></div></div><div><h3>Explanation&nbsp;</h3><div><div><p>To search multiple worksheets in a workbook for a value and return a count, you can use a formula based on the COUNTIF and INDIRECT functions. With some setup, you use this approach to search an entire workbook for a specific value.</p><p>In the example shown, the formula in C5 is:</p><div><pre>=COUNTIF(INDIRECT("'"&amp;B7&amp;"'!"&amp;"1:1048576"),$C$4)</pre></div><h3>Context - sample data</h3><p>The workbook contains 4 worksheets total. Sheet1, Sheet2, and Sheet3 each contain 1000 random first names that look like this:</p><p><img src=https://exceljet.net/sites/default/files/styles/original_with_watermark/public/images/formulas/inline/search%20multiple%20worksheets%20sample%20data.png?itok=Z89QZCK_ alt="" data-elem=pinchzoomer /></p><h3>How this formula works</h3><p>The range B7:B9 contains the Sheets we want to count.</p><p>Working from the inside out, this expression is used to build a full sheet reference:</p><div><pre>"'"&amp;B7&amp;"'!"&amp;"1:1048576"</pre></div><p>The single quotes are added to allow sheet names with spaces, and the exclamation mark is a standard syntax for ranges that include a sheet name. The text "1:1048576" is a range that includes every row in the worksheet.</p><p>After B7 is evaluated, and values are concatenated, the expression above returns:</p><div><pre>"'Sheet1'!1:1048576"</pre></div><p>which is goes into the INDIRECT function as the 'ref_text' argument. INDIRECT then evaluates this text and returns a standard reference to every cell in Sheet1. This goes into the COUNTIF function as the range. The criteria is provided as an absolute reference to C4 (locked so the formula can be copied down column C).</p><p>COUNTIF then returns a count of all cells with a value equal to "mary", 25 in this case.</p><p><I>Note: COUNTIF is not case-sensitive.</I></p><h3>Contains vs. Equals</h3><p>If you want to count all cells that contain the value in C4, instead of all cells equal to C4, add the wildcards to the criteria like this:</p><div><pre>=COUNTIF(INDIRECT("'"&amp;B7&amp;"'!"&amp;"1:1048576"),"*"&amp;C4&amp;"*")</pre></div><p>Now COUNTIF will count cells with the substring "John" anywhere in the cell.</p><h3>Performance</h3><p>In general, it's not a good practice to specify a range that includes all worksheet cells. Doing so can cause major performance problems, since the range includes millions and millions of cells. In this example, the problem is compounded, since the formula uses the INDIRECT function, which is a volatile function. Volatile functions recalculate on every worksheet change, so the impact on performance can be huge.</p><p>When possible, restrict all ranges to a sensible size.</p></div></div></div><div><div></div></div><div data-role=footer data-position=fixed data-tap-toggle=false data-theme=c><a href=#pageone data-rel=back data-icon=home data-iconpos="" data-shadow=true data-iconshadow=true>Back</a></div></div><meta charset=utf-8 /><link rel=stylesheet type=text/css href=css/jquery.mobile.squareui.css /><script src="js/jquery.js"></script> <script src="js/jquery.mobile-1.4.0.min.js"></script><link href=css/pinchzoomer.min.css rel=stylesheet><link href=css/fullscreen.min.css rel=stylesheet><script src="js/jquery-1.10.0.min.js" type="text/javascript"></script> <script src="js/bootstrap.min.js" type="text/javascript"></script> <script src="js/modernizr.min.js" type="text/javascript"></script> <script src="js/jquery.mousewheel.min.js"></script> <script src="js/jquery.hammer.min.js" type="text/javascript"></script> <script src="js/TweenMax.min.js" type="text/javascript"></script> <script src="js/fullscreen.min.js" type="text/javascript"></script><meta name=format-detection content=telephone=no /></body></html>